<%- include('navbar.ejs') %>
	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">


	<div class="container mt-4">
		<div class="card shadow">
			<div class="card-header bg-dark text-white p-4 fw-bold" style="background-color: rgba(61, 56, 126, 0.651);">
				<h4 class="mb-0">Add New Site</h4>
			</div>
			<div class="card-body">
				<form action="/admin/save_site" method="POST" enctype="multipart/form-data">
					<div class="row g-3">

						<div class="col-md-3">
							<label for="site_name" class="form-label">Site Name</label>
							<input type="text" class="form-control" id="site_name" name="site_name" maxlength="100"
								required>
						</div>
						<div class="col-md-3">
							<label for="site_location" class="form-label">Site Location</label>
							<input type="text" class="form-control" id="site_location" name="site_location"
								maxlength="255">
						</div>
						<div class="col-md-3">
							<label for="site_manager_name" class="form-label">Manager Name</label>
							<input type="text" class="form-control" id="site_manager_name" name="site_manager_name"
								maxlength="100">
						</div>
						<div class="col-md-3">
							<label for="site_structure_image" class="form-label">Structure Image</label>
							<input type="file" class="form-control" id="site_structure_image"
								name="site_structure_image" accept="image/*">
						</div>
						<div class="col-md-3">
							<label for="site_3d_image" class="form-label">3D Image</label>
							<input type="file" class="form-control" id="site_3d_image" name="site_3d_image"
								accept="image/*">
						</div>
						<div class="col-md-3">
							<label for="site_start_date" class="form-label">Start Date</label>
							<input type="date" class="form-control" id="site_start_date" name="site_start_date">
						</div>
						<div class="col-md-3">
							<label for="site_completed_date" class="form-label">Completed Date</label>
							<input type="date" class="form-control" id="site_completed_date" name="site_completed_date">
						</div>

						<div class="mb-3 col-md-3">
							<label for="total_area_sqft" class="form-label">Total Area (sqft)</label>
							<input type="number" step="0.01" class="form-control" id="total_area_sqft"
								name="total_area_sqft" required>
						</div>

						<div class="mb-3 col-md-3">
							<label for="flats_per_floor" class="form-label">Flats per Floor</label>
							<input type="number" class="form-control" id="flats_per_floor" name="flats_per_floor"
								required>
						</div>

						<!-- Total Floors -->
						<div class="mb-3 col-md-3">
							<label for="total_floors" class="form-label">Total Floors</label>
							<input type="number" class="form-control" id="total_floors" name="total_floors" required>
						</div>
						<div class="mb-3 col-md-3">
							<label for="total_flats" class="form-label">Total Flats</label>
							<input type="number" class="form-control" id="total_flats" name="total_flats" readonly>
						</div>
						<!-- Total Flats (auto calculate JS) -->
						<div class="mb-3 col-md-3">
							<label for="flat_area_sqft" class="form-label">Flat Area (sqft)</label>
							<input type="number" step="0.01" class="form-control" id="flat_area_sqft"
								name="flat_area_sqft" readonly>
						</div>


						<div class="col-md-12">
							<label for="site_description" class="form-label">Site Details</label>
							<textarea class="form-control" id="editor" name="site_description"></textarea>
						</div>
					</div>
					<div class="row mt-3">
						<div class="col-md-12 text-end">
							<button type="submit" class="btn btn-primary btn-lg">Add Site</button>
						</div>
					</div>
				</form>
			</div>
		</div>
	</div>

	<script>
		CKEDITOR.replace('site_description');
	</script>



	<script>
		function calculateDetails() {
			let totalArea = parseFloat(document.getElementById("total_area_sqft").value) || 0;
			let flatsPerFloor = parseInt(document.getElementById("flats_per_floor").value) || 0;
			let totalFloors = parseInt(document.getElementById("total_floors").value) || 0;

			// Calculate total flats
			let totalFlats = flatsPerFloor * totalFloors;
			document.getElementById("total_flats").value = totalFlats;

			// Calculate flat area
			if (totalArea > 0 && totalFlats > 0) {
				document.getElementById("flat_area_sqft").value = (totalArea / totalFlats).toFixed(2);
			}
		}

		document.getElementById("total_area_sqft").addEventListener("input", calculateDetails);
		document.getElementById("flats_per_floor").addEventListener("input", calculateDetails);
		document.getElementById("total_floors").addEventListener("input", calculateDetails);
	</script>

	<%- include('footer.ejs') %>